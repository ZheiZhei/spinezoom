<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<script src="https://timmywil.com/panzoom/demo/panzoom.js"></script>
<script src="https://gw.alipayobjects.com/os/lib/tinyjs/tiny/1.3.1/tiny.js"></script>
<script src="./index.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.15.3/css/all.css">
<style>
.panzoom-parent {
  position: relative;
  box-sizing: border-box;
}
.panzoom {
  position: relative;
}
.button button {
	display: inline-block;
	position: absolute;
	width: 45px;
	height: 45px;
	border: none;
	background: #454645;
}
.enable-button {
	top: 10px;
	left: 10px;
}
.reset-button {
	top: 65px;
	left: 10px;
}
.dyn-button {
	top: 10px;
	left: 65px;
}
.button i {
	color: #D5D5D5;
}
.prof {
	position: absolute;
	bottom: 150px;
	left: 10px;
	color: #FFFFFF;
	text-align: center;
	font-weight: bold;
	font-size: 16pt;
}
.juexing {
	position: absolute;
	top: 75px;
	left: 15px;
}
.juexing input {
	width: 55px;
	height: 50px;
	border: none;
	background-repeat: no-repeat;
	background-position: center;
	background-size: 110px 100px;
	background-color: rgba(0,0,0,0);
}
.rare {
	position: absolute;
	bottom: 80px;
	left: 10px;
}
.code {
	position: absolute;
	bottom: 45px;
	left: 10px;
	color: #FFFFFF;
	font-size: 24pt;
}
.bar {
	position: absolute;
	width: 25%;
	height: 25px;
	bottom: 15px;
	background: #FFEC10;
}
.logo {
	position: absolute;
	top: 5px;
	right: 105px;
}
.logo img {
	width: 300px;
	height: 180px;
}
.blind {
	position: absolute;
	bottom: 150px;
	left:150px;
}
.blind #main {
	width: 75px;
}
.blind #sub {
	position: relative;
	left: -20px;
	display: none;
}
.profile {
	position: absolute;
	bottom: 20px;
	right: 15px;
	color: #FFFFFF;
	width: 450px;
	font-size: 14pt;
}
.profile span:first-child {
	font-size: 20pt;
	font-weight: bolder;
}
.profile #team {
	font-size: 20pt;
	font-weight: bolder;
	float: right;
}
.shadow {
	position: absolute;
	top: 0;
	width: 100%;
	height: 100%;
	box-shadow: inset 0em -5em 15em black;
}
#background {
	height: 600px;
	background-size: 100% 600px;
}
@media only screen and (max-width: 980px) {
#background {
	height: 1200px;
	background-size: 100% 1200px;
}
.button button {
width: 90px;
height: 90px;
}
.enable-button {
top: 10px;
left: 10px;
}
.reset-button {
	top: 110px;
	left: 10px;
}
.dyn-button {
	top: 10px;
	left: 110px;
}
.logo {
	top: 5px;
	right: 0px;
}
.logo img {
	width: 400px;
	height: 240px;
}
.juexing {
	top: 145px;
	left: 15px;
}
.juexing input {
	width: 110px;
	height: 100px;
	background-size: 220px 200px;
}
.prof {
	bottom: 275px;
	left: 15px;
	color: #FFFFFF;
	text-align: left;
	font-weight: bold;
	font-size: 32pt;
}
.blind {
	position: absolute;
	bottom: 330px;
	left: 150px;
}
.rare {
	bottom: 215px;
	left: 15px;
}
.code {
	bottom: 65px;
	left: 15px;
	font-weight: bold;
	font-size: 56pt;
}
.code-en {
	font-weight: normal;
	font-size: 32pt;
}
.bar {
	position: absolute;
	width: 45%;
	height: 25px;
	bottom: 25px;
}
.profile {
	bottom: 20px;
	right: 20px;
	width: 450px;
	font-size: 18pt;
}
.profile span:first-child {
	font-size: 30pt;
	font-weight: bolder;
}
.profile #team {
	display: none;
}
}
</style><div class="panzoom-parent" id="background" style="max-width: 1200px; border-width: 10px; overflow: hidden; user-select: none; touch-action: none; background-image: url('https://i.loli.net/2021/07/15/VNdMjzWZ53gkRCr.png');">
	<div id="tachie" class="panzoom" style="width: 2048px; height: 2048px; cursor: move; user-select: none; touch-action: none; transform-origin: 50% 50%; pointer-events: none;">
		<div id="dyn" style="width: 100%; height:100%; cursor: move; user-select: none; touch-action: none; display: none;"></div>
		<div id="sta" style="width: 100%; height:100%; cursor: move; user-select: none; touch-action: none;">
			<img id="sta0" width="100%" height="100%" src="https://i.loli.net/2021/07/15/lyWBD8UM5ShgYju.png">
			<img id="sta3" width="100%" height="100%" src="https://i.loli.net/2021/07/15/p8Gld7aD1TkifQ4.png" style="display: none;">
		</div>
	</div>
	<div class="shadow"></div>
	<span class="button">
		<button type="submit" class="enable-button" id="enable-on"><i class="fas fa-search-plus fa-2x"></i></button><button type="submit" class="enable-button" id="enable-off" style="display: none;"><i class="fas fa-search-minus fa-2x"></i></button><button type="submit" class="reset-button" id="reset" style="display: none;"><i class="fas fa-sync-alt fa-2x"></i></button><button type="submit" class="dyn-button" id="dyn-on"><i class="fas fa-toggle-off fa-2x"></i></button></button><button type="submit" class="dyn-button" id="dyn-off" style="display: none;"><i class="fas fa-toggle-on fa-2x"></i></button>
	</span>
	<span class="juexing">
		<input id="juexing0" type="button" style="background-image:url('https://i.loli.net/2021/07/15/nB9iMNsCwodQK8Z.png');"><br>
		<input id="juexing1" type="button" style="background-image:url('https://i.loli.net/2021/07/15/FOrfCMkQ5UZxHG4.png'); filter: opacity(0.25)"><br>
		<input id="juexing2" type="button" style="background-image:url('https://i.loli.net/2021/07/15/jhnEYzaekRXVWpx.png'); filter: opacity(0.25)"><br>
		<input id="juexing3" type="button" style="background-image:url('https://i.loli.net/2021/07/15/QIZBvznd4NpFsVi.png'); filter: opacity(0.25)">
	</span>
	<span class="prof"><img src="https://i.loli.net/2021/07/15/GiDE2zu9pemKINS.png"><br><span>チェンジャー</span></span>
	<span class="blind"><img id="main" src="https://i.loli.net/2021/07/15/rUywEd17ov4TDxS.png"><img id="sub" src="https://i.loli.net/2021/07/15/9AR6esoXzZxLk53.png"></span>
	<span class="rare"><img><img><img><img><img></span>
	<span class="code">ナミシス<span class="code-en">NEMESIS</span></span>
	<span class="bar"></span>
	<span class="logo"><img src="https://i.loli.net/2021/07/15/i6bMHWkpcG5F3aZ.png"></span>
	<span class="profile">
		<span>光霊紹介PROFILE</span><span id="team">啓光連邦</span><br>
		<span>啓光連邦のメンバー。昔ながらの騎士道精神が感じられる物言いで、自身の行動には細心の注意を払っている。その結果軍の憲兵隊司令官に任命され、鉄壁ともいえる公平な執務で皆の信頼を獲得した</span>
	</span>
</div>
<script>
var bodyWidth = document.body.offsetWidth
const elem = document.getElementById('tachie')
if( bodyWidth <= 964 ) {
	panzoom = Panzoom(elem, { contain: 'outside', startScale: 1.2 , startX: -bodyWidth/2 , startY: -270 , minScale : 1.2})
	$('.button i').addClass("fa-4x")
	$('.code-en').before("<br>")
}
else {
	panzoom = Panzoom(elem, { contain: 'outside', startScale: 0.7 , startX: -685 , startY: -940 , minScale : 0.7 })
}
const parent = elem.parentElement
const resetButton = document.getElementById('reset')
const enableButton = document.getElementById('enable-off')
resetButton.addEventListener('click', panzoom.reset)
$(document).ready(function(){
	$('.rare img').attr("src","https://i.loli.net/2021/07/15/RBQwJSihtCyuKDE.png")
	console.log(bodyWidth)
})
$('#enable-on').click(function(e){
	$('#tachie').css("pointer-events","auto")
	parent.addEventListener('wheel', panzoom.zoomWithWheel)
	$('#enable-on').css("display","none")
	$('#enable-off').css("display","inline-block")
	$(".juexing, #reset, .prof, .blind, .bar, .logo, .code, .rare, .profile, .shadow").fadeToggle(250)
})
$('#enable-off').click(function(e){
	$('#tachie').css("pointer-events","none")
	parent.removeEventListener('wheel', panzoom.zoomWithWheel)
	$('#enable-off').css("display","none")
	$('#enable-on').css("display","inline-block")
	$(".juexing, #reset, .prof, .blind, .bar, .logo, .code, .rare, .profile, .shadow").fadeToggle(250)
})
$('#dyn-on').click(function(e){
	$('#dyn-on').css("display","none")
	$('#sta').css("display","none")
	$('#dyn-off').css("display","inline-block")
	$('#dyn').css("display","inline-block")
})
$('#dyn-off').click(function(e){
	$('#dyn-off').css("display","none")
	$('#dyn').css("display","none")
	$('#dyn-on').css("display","inline-block")
	$('#sta').css("display","inline-block")
})
$('#juexing0').click(function(e){
	$('#sta0').css("display","inline-block")
	$('#sta3, #sub').css("display","none")
	$('.juexing input').css("filter","opacity(0.25)")
	$('#juexing0').css("filter","opacity(1)")
	app.run(container[1])
})
$('#juexing1').click(function(e){
	$('#sta0').css("display","inline-block")
	$('#sta3, #sub').css("display","none")
	$('.juexing input').css("filter","opacity(0.25)")
	$('#juexing1').css("filter","opacity(1)")
	app.run(container[1])
})
$('#juexing2').click(function(e){
	$('#sta0').css("display","inline-block")
	$('#sta3, #sub').css("display","none")
	$('.juexing input').css("filter","opacity(0.25)")
	$('#juexing2').css("filter","opacity(1)")
	app.run(container[1])
})
$('#juexing3').click(function(e){
	$('#sta0').css("display","none")
	$('#sta3, #sub').css("display","inline-block")
	$('.juexing input').css("filter","opacity(0.25)")
	$('#juexing3').css("filter","opacity(1)")
	app.run(container[2])
})
</script>
<script type="text/javascript">
	// 指定 Spine 模型数量
	  var i = 2;
	
	  var app = new Tiny.Application({
		dpi: 1,
		showFPS: false,
		width: 2048,
		height: 2048,
		fixSize: true,
		renderOptions: {
		  transparent: true,
		},
	  });
	
	  document.getElementById('dyn').appendChild(app.view);
	
	  var spineInstance = [];
	  var loader = new Tiny.loaders.Loader();
	  var container = [];
	  
	  for (var x = 1; x <= i; x++) {
		container[x] = new Tiny.Container();
	  }
	  // 指定数组对应的资源名
	  var onAssetsLoaded = function(loader, res) {
		spineInstance[1] = new Tiny.spine.Spine(res.spineRes1.spineData);
		spineInstance[2] = new Tiny.spine.Spine(res.spineRes2.spineData);
	
		for (var x = 1; x <= i; x++) {
		spineInstance[x].skeleton.setSkinByName('default');
		container[x].addChild(spineInstance[x]);
	
		spineInstance[x].setPosition(1024, 1024);
		spineInstance[x].state.setAnimation(0, 'idle', true);
		}
	  }
	  // 指定资源位置及缩放比例，三种文件需在同一目录下
	  loader
		.add({
		  name: 'spineRes1',
		  url: 'https://raw.githubusercontent.com/ZheiZhei/spinezoom/master/resource/1500121/1500121_spine_idle.skel',
		  metadata: {
			spineSkeletonScale: 0.245,
		  }
		});
	  loader
		.add({
		  name: 'spineRes2',
		  url: 'https://raw.githubusercontent.com/ZheiZhei/spinezoom/master/resource/1500122/1500122_spine_idle.skel',
		  metadata: {
			spineSkeletonScale: 1,
		  }
		});
	  loader.load(onAssetsLoaded);
	  app.run(container[1]);
</script>
